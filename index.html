<html>
    <body>
        <div>
            <input type = "text" id = "amount">
            <p id = "balance"></p>
            <button id = 'deposit'>Deposit</button>
            <button id = 'withdraw'>Withdraw</button>
        </div>

        <!-- <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script> -->
        <script src="https://unpkg.com/web3@latest/dist/web3.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

        <script>
            var contract;

            $(document).ready(function() {
                web3 = new Web3(web3.currentProvider);

                var address = "0x8E6EDeAB1Cdec69Cde0Cf6673EE6DcB95625A5a5";
                var abi = [
                    {
                        "inputs": [],
                        "stateMutability": "nonpayable",
                        "type": "constructor"
                    },
                    {
                        "inputs": [
                            {
                                "internalType": "int256",
                                "name": "amt",
                                "type": "int256"
                            }
                        ],
                        "name": "deposit",
                        "outputs": [],
                        "stateMutability": "nonpayable",
                        "type": "function"
                    },
                    {
                        "inputs": [],
                        "name": "getBal",
                        "outputs": [
                            {
                                "internalType": "int256",
                                "name": "",
                                "type": "int256"
                            }
                        ],
                        "stateMutability": "view",
                        "type": "function"
                    },
                    {
                        "inputs": [
                            {
                                "internalType": "int256",
                                "name": "amt",
                                "type": "int256"
                            }
                        ],
                        "name": "withdraw",
                        "outputs": [],
                        "stateMutability": "nonpayable",
                        "type": "function"
                    }
                ]

                contract = new web3.eth.Contract(abi, address);

                contract.methods.getBal().call().then(function(bal){
                    $('#balance').html(bal);
                })

            })

            $('#deposit').click(function() {
                // const ethereum = window.ethereum;
                const web3 = window.web3;
                // const web3Instance = new Web3(ethereum);
                // const enabledWeb3 = ethereum.enable();

                var amt = 0;
                amt = parseInt($('#amount').val());

                web3.eth.getAccounts().then((accounts) => {
                    tmp = accounts;
                    var acc = tmp[0];
                    //console.log(acc);
                    return contract.methods.deposit(amt).send({from : acc});
                })
                .then(function(tx){
                    console.log(tx);
                }).catch(function(tx){
                    console.log(tx);
                })
            })

            $('#withdraw').click(function() {
                // const ethereum = window.ethereum;
                const web3 = window.web3;
                // const web3Instance = new Web3(ethereum);
                // const enabledWeb3 = ethereum.enable();

                var amt = 0;
                amt = parseInt($('#amount').val());

                web3.eth.getAccounts().then((accounts) => {
                    tmp = accounts;
                    var acc = tmp[0];
                    //console.log(acc);
                    return contract.methods.withdraw(amt).send({from : acc});
                })
                .then(function(tx){
                    console.log(tx);
                }).catch(function(tx){
                    console.log(tx);
                })
            })
        </script>
    </body>
</html>